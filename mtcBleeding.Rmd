---
title: "NOAC network meta-analysis: Bleeding"
author: "Benjamin Chan"
date: "`r Sys.time()`"
output: 
  html_document: 
    keep_md: yes
    toc: yes
---

[Back](README.md) to main page.

Read data.

```{r}
D <- readSheet("Bleeding")
D <- D[!is.na(label)]
D <- D[,
       `:=` (nWarfarin = as.numeric(nWarfarin),
             yWarfarin = as.numeric(yWarfarin))]
```

Tidy up the data and bias the warfarin arm of ROCKET-AF in favor of warfarin.

```{r, results='asis'}
D <- tidyData(D)
D <- biasROCKETAF()
```

Hard-code data corrections to the PETRO study.

> From: Marian McDonagh  
> Sent: Friday, February 05, 2016 5:00 PM  
> To: Benjamin Chan  
> Subject: Re: Checking data for meta-analysis  
> 
> It looks like this was a dose-ranging studies with multiple arms.
> The only relevant one here had 0 events in the dabigatran 150 group (N = 100),
> and of course 0 in the warfarin group (N = 70).

```{r}
D <- D[study == "PETRO" & treatment == "Dabigatran_300_mg",
       `:=` (treatment = "Dabigatran_150_mg",
             responders = 0,
             sampleSize = 100)]
```

```{r, echo=FALSE, results='asis'}
write.csv(D, file="mtcBleedingData.csv", row.names=FALSE)
print(xtable(D, digits=rep(0, 5)), type="html", include.rownames=FALSE)
D <- D[!is.na(responders)]
network <- mtc.network(D)
```

Run the model using `r sprintf("%s-effects", effect)`.

```{r, child="model.Rmd"}
```

# Summary

Direct and indirect odds ratios and 95% confidence bounds are stored in
[mtcBleedingOddsRatios.csv](mtcBleedingOddsRatios.csv).

```{r, results='asis'}
or <- combineResults(outcomeBleeding=TRUE)
write.csv(or, file="mtcBleedingOddsRatios.csv", row.names=FALSE)
print(xtable(or), type="html", include.rownames=FALSE)
```

# Forest plots, NOAC vs NOAC

```{r, child="forestPlots.Rmd"}
```

# Diagnostics

```{r, child="modelDiagnostics.Rmd"}
```
